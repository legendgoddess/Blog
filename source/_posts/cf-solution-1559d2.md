---
title: CF1559D2 Mocha and Diana (Hard Version)
date: 2021-10-01 21:29:11
tags:
  - 贪心
  - 构造
categories:
  - CF题解
---

<h3><center>CF1559D2 Mocha and Diana (Hard Version)</center></h3>

> [CF1559D2 Mocha and Diana (Hard Version)](https://www.luogu.com.cn/problem/CF1559D2)

> 做过 /qd

暴力就是直接枚举每条边是否被加入。

证明一下这个东西：

如果说存在有一条边不被加入，然后可以多增加两条边。那么增加的两条边肯定是连接了 $3$ 个连通块，而断掉一条边只能产生 $2$ 个连通块，说明肯定有一个连通块之前没有加入，和最优秀的情况矛盾，所以成立。

---

那么根据之前这个结论我们直接进行暴力加边即可。

我们发现对于最终的情况本质上肯定是对于任意一个 $A$ 中的连通块想和其他联通块相连，$B$ 中肯定都是同一个连通块。

那么肯定是可以构成树的。

我们直接考虑钦定树上任意一个节点作为根进行计算即可。

---

那么现在这一步就是贪心了，先加入两边都可以加入的边。不然的话就是如果一边已经加入了边，那么另外一边显然也是可以加入的，使用并查集维护一下即可。

复杂度是 $O(n \alpha(n))$。




